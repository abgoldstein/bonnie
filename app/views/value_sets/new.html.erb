<% content_for :head do %>
  <script type="text/javascript">
    $(document).ready(function() {
      value_set_functions = new ValueSetFunctions();
      value_set_functions.bind_add_code();
      // value_set_functions.bind_submit();
    });
  </script>
<% end %>

<% content_for :page_content do %>

  <div class="row">
  <div class="span6 offset1">

    <%= form_for @value_set, :html => {:class=>'form-horizontal'}  do |f| %>
      <fieldset>
        <legend>New Value Set</legend>
          <%= f.label :oid  %>
          <%= f.text_field :oid, :value => '1.2.3' %>
        
          <%= f.label "Description" %>
          <%= f.text_field :description, :value => 'description' %>

          <%= f.label "Category" %>
          <%= f.text_field :category, :value => 'medication' %>

      
        <fieldset>
          <legend>Code Sets</legend>
          <%# order does not matter here %>
          <p class="help-block">Add multiple code sets</p>
          <div id="code_sets[0]">
            <%= f.fields_for 'code_sets[0]' do |code_set_fields| %>
            <div class="control-group">
              <%= f.label 'code set 0', :class => "control-label" %>
              <div class="controls row well">
                <div class="span6">
                  <%= code_set_fields.label :code_set %>
                  <%= code_set_fields.text_field :code_set, :value => 'ICD-9-CM' %>
                </div>
                <div class="span6">
                  <%= code_set_fields.label :category %>
                  <%= code_set_fields.text_field :category, :value => 'category' %>
                </div>
                <div class="span6">
                  <%= code_set_fields.label :concept, :class => 'input-small' %>
                  <%= code_set_fields.text_field :concept, :class => 'input-small', :value => 'concept' %>
                </div>
            
                <div class="row">
                <div id="codes" class="control-group">                
                    <%= code_set_fields.label :codes, :class => "control-label" %>
                    <a class="btn btn-primary btn-small">+</a>
                    <div class="controls row span3">
                      <%= code_set_fields.text_field 'codes[0]', :class => 'input-small', :value => 'code0' %><br>
                      <%= code_set_fields.text_field 'codes[1]', :class => 'input-small', :value => 'code1' %><br>
                    </div>
                </div>
                </div>
              <% end %>                
              </div>
            </div><!-- control group end -->    
          </div><!-- code_sets end -->
        </fieldset><!-- code_sets end -->

      </fieldset><!-- value_set end -->
    
      <div class="form-actions">
        <%= f.submit :class => "btn btn-primary" %>
      </div>
    <% end %><!-- form end -->
  </div>
  </div>
  
  <div id="response"></div>
<% end %>